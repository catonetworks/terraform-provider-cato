---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "cato_tls_rule Resource - terraform-provider-cato"
subcategory: ""
description: |-
  The _tls_rule resource contains the configuration parameters necessary to add rule to the TLS Inspection Policy. Documentation for the underlying API used in this resource can be found at mutation.policy.tlsInspect.addRule() https://api.catonetworks.com/documentation/#mutation-policy.tlsInspect.addRule.
---

# cato_tls_rule (Resource)

The `_tls_rule` resource contains the configuration parameters necessary to add rule to the TLS Inspection Policy. Documentation for the underlying API used in this resource can be found at [mutation.policy.tlsInspect.addRule()](https://api.catonetworks.com/documentation/#mutation-policy.tlsInspect.addRule).

## Example Usage

```terraform
# As a best practice, add custom categories to map to the following phases for TLS Inspection used in rules
# https://support.catonetworks.com/hc/en-us/articles/13314286857501-Working-with-Categories
# TLSi_Phase_1: Alcohol and Tobacco, Anonymizers, Botnets, Cheating, Compromised, Criminal Activity, Cults, Hacking, Illegal Drugs, Keyloggers, Malware, Nudity, P2P, Parked domains, Phishing, Porn, Questionable, SPAM, Spyware, Tasteless, Violence and Hate, Weapons, 
# TLSi_Phase_2: Entertainment, Gambling, Games, Greeting Cards, Leisure and Recreation, News, Politics, Real Estate, Religion, Sex education, Shopping, Sports, Vehicles, Web Hosting, 

# Create section for custom TLS rules 
resource "cato_tls_section" "section1" {
    at = {
        position = "LAST_IN_POLICY"
    }
    section = {
        name = "Custom TLS Rules"
    }    
}

# Create first section for TLS phases
resource "cato_tls_section" "section2" {
    at      = {
        position = "AFTER_SECTION"
        ref = cato_tls_section.section1.section.id
    }
    section = {
        name = "TLS Phases"
    }    
}

# Create rules in sections
resource "cato_tls_rule" "TLSi_Phase_1" {
    at = {
        position = "FIRST_IN_SECTION"
        ref = cato_tls_section.section2.section.id
    }
    rule = {
        action                       = "INSPECT"
        application                  = {
            custom_category = [
                {
                    # id   = "12345"
                    name = "TLSi_Phase_1"
                },
            ]
        }
        connection_origin            = "ANY"
        enabled                      = true
        name                         = "TLSi_Phase_1_inspection"
        source                       = {
            # Filter phase 1 to applyto specific set of sites or users
            users_group = [
                {
                    # id   = "12345"
                    name = "Your User Group Here"
                },
            ]
            site = [
                {
                    # id   = "12345"
                    name = "Your Site Name"
                },
            ]
        }
        untrusted_certificate_action = "ALLOW"
    }
}

resource "cato_tls_rule" "TLSi_Phase_2" {
    at   = {
        position = "AFTER_RULE"
        ref = cato_tls_rule.TLSi_Phase_1.id
    }
    rule = {
        action                       = "INSPECT"
        application                  = {
            custom_category = [
                {
                    id   = "37294"
                    name = "TLSi_Phase_2"
                },
            ]
        }
        connection_origin            = "ANY"
        enabled                      = true
        name                         = "TLSi_Phase_2_inspection"
        source                       = {
            users_group = [
                {
                    # id   = "12345"
                    name = "Your User Group Here"
                },
            ]
            site = [
                {
                    # id   = "12345"
                    name = "Your Site Name"
                },
            ]
        }
        untrusted_certificate_action = "ALLOW"
    }
}

resource "cato_tls_rule" "TLSi_Phase_2" {
    at   = {
        position = "AFTER_RULE"
        ref = cato_tls_rule.TLSi_Phase_2.id
    }
    rule = {
        action                       = "INSPECT"
        application                  = {}
        connection_origin            = "ANY"
        enabled                      = true
        name                         = "TLSi_Phase_3_inspection"
        source                       = {}
        untrusted_certificate_action = "ALLOW"
    }
}

resource "cato_if_rule" "example_kitchen_sink" {
    at   = {
      position = "LAST_IN_SECTION"
      ref      = cato_tls_section.section1.section.id
    }
    rule = {
        name              = "Internet Firewall Kitchen Sink"
        action            = "ALLOW"
        active_period     = {
          effective_from = "2025-08-09T00:00:00"
          expires_at     = "2026-12-31T23:57:59"
        }
        connection_origin = "REMOTE"
        country           = [
            {
                id   = "AG"
                # name = "Antigua and Barbuda"
            },
            {
                # id   = "AW"
                name = "Aruba"
            },
        ]
        description       = "test description"
        destination       = {
            app_category             = [
                {
                    # id   = "anonymizers"
                    name = "Anonymizers"
                },
                {
                    # id   = "authentication_services"
                    name = "Authentication Services"
                },
            ]
            application              = [
                {
                    # id   = "ebix"
                    name = "Ebix Inc."
                },
                {
                    id   = "fotocasa"
                    # name = "Fotocasa"
                },
            ]
            country                  = [
                {
                    # id   = "AI"
                    name = "Anguilla"
                },
                {
                    # id   = "AQ"
                    name = "Antarctica"
                },
            ]
            custom_app               = [
                {
                    # id   = "CustomApp_11362_34188"
                    name = "Test Custom App"
                },
            ]
            custom_category          = [
                {
                    # id   = "24255"
                    name = "Test Custom Category"
                },
                {
                    # id   = "27782"
                    name = "RBI-URLs"
                },
            ]
            domain                   = [
                "test.com",
            ]
            fqdn                     = [
                "www.test.com",
            ]
            global_ip_range          = [
                {
                    # id   = "1757826"
                    name = "global_ip_range"
                },
                {
                    # id   = "1910542"
                    name = "global_ip_range2"
                },
            ]
            ip                       = [
                "1.2.3.4",
            ]
            ip_range                 = [
                {
                    from = "1.2.3.4"
                    to   = "1.2.3.5"
                },
            ]
            remote_asn               = [
                "12",
            ]
            sanctioned_apps_category = [
                {
                    # id   = "22736"
                    name = "Sanctioned Apps"
                },
            ]
            subnet                   = [
                "1.2.3.0/24",
            ]
        }
        device            = [
            {
                # id   = "4202"
                name = "Test Device Posture Profile"
            },
        ]
        device_attributes = {
            category     = [
                "IoT",
                "Mobile",
            ]
            manufacturer = [
                "ADTRAN",
                "ACTi",
            ]
            model        = [
                " 9",
                " 7+",
            ]
            os           = [
                "Aruba OS",
                "Arch Linux",
            ]
            type         = [
                "Appliance",
                "Analog Telephone Adapter",
            ]
        }
        device_os         = [
            "WINDOWS",
            "MACOS",
        ]
        enabled           = true
        schedule          = {
            active_on        = "CUSTOM_RECURRING"
            custom_recurring = {
                days = [
                    "SUNDAY",
                    "WEDNESDAY",
                    "SATURDAY",
                    "THURSDAY",
                    "MONDAY",
                    "TUESDAY",
                    "FRIDAY",
                ]
                from = "02:02:00"
                to   = "03:03:00"
            }
        }
        service           = {
            custom   = [
                {
                    port       = []
                    port_range = {
                        from = "10"
                        to   = "50"
                    }
                    protocol   = "UDP"
                },
                {
                    port     = [
                        "22",
                    ]
                    protocol = "UDP"
                },
            ]
            standard = [
                {
                    # id   = "amazon_ec2"
                    name = "Amazon EC2"
                },
            ]
        }
        source            = {
            floating_subnet     = [
                {
                    id   = "1474041"
                    # name = "floating_range"
                },
                {
                    id   = "1910541"
                    # name = "floating_range2"
                },
            ]
            global_ip_range     = [
                {
                    # id   = "1757826"
                    name = "global_ip_range"
                },
                {
                    # id   = "1910542"
                    name = "global_ip_range2"
                },
            ]
            group               = [
                {
                    # id   = "623603"
                    name = "test group"
                },
            ]
            host                = [
                {
                    # id   = "1700335"
                    name = "my.hostname25"
                },
                {
                    # id   = "1778359"
                    name = "host31"
                },
            ]
            ip                  = [
                "1.2.3.4",
            ]
            ip_range            = [
                {
                    from = "1.2.3.4"
                    to   = "1.2.3.5"
                },
            ]
            network_interface   = [
                {
                    id   = "124986"
                    # name = "ipsec-dev-site \\ Default"
                },
                {
                    id   = "175651"
                    # name = "TestSite001 \\ Default"
                },
            ]
            site                = [
                {
                    # id   = "144904"
                    name = "1600LTE"
                },
                {
                    # id   = "144905"
                    name = "1600"
                },
            ]
            site_network_subnet = [
                {
                    id   = "TjE3MDE0NDI="
                    # name = "aws-site \\ LAN \\ Native Range"
                },
                {
                    id   = "TjIyMzcxODI="
                    # name = "Cato-X1600 \\ LAN88 \\ Native Range"
                },
            ]
            subnet              = [
                "1.2.3.0/24",
            ]
            system_group        = [
                {
                    # id   = "2S"
                    name = "All SDP Users"
                },
                {
                    # id   = "7S"
                    name = "All Floating Ranges"
                },
            ]
            user                = [
                {
                    # id   = "0"
                    name = "test user"
                },
            ]
            users_group         = [
                {
                    # id   = "500000001"
                    name = "Operations Team"
                },
            ]
        }
        tracking          = {
            alert = {
                enabled      = true
                frequency    = "WEEKLY"
                mailing_list = [
                    {
                        id   = "-100"
                        # name = "All Admins"
                    },
                ]
            }
            event = {
                enabled = true
            }
        }
    }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `at` (Attributes) Position of the rule in the policy (see [below for nested schema](#nestedatt--at))
- `rule` (Attributes) Parameters for the rule you are adding (see [below for nested schema](#nestedatt--rule))

### Read-Only

- `id` (String) Identifier of the TLS Inspection Rule

<a id="nestedatt--at"></a>
### Nested Schema for `at`

Required:

- `position` (String) Position relative to a policy, a section or another rule (FIRST_IN_POLICY, LAST_IN_POLICY, FIRST_IN_SECTION, LAST_IN_SECTION, BEFORE_RULE, AFTER_RULE)

Optional:

- `ref` (String) The identifier of the object (e.g. a rule, a section) relative to which the position of the added rule is defined


<a id="nestedatt--rule"></a>
### Nested Schema for `rule`

Required:

- `action` (String) The action applied by TLS Inspection if the rule is matched (INSPECT, BYPASS)
- `enabled` (Boolean) Attribute to define rule status (enabled or disabled)
- `name` (String) Name of the rule

Optional:

- `application` (Attributes) Application matching criteria (see [below for nested schema](#nestedatt--rule--application))
- `connection_origin` (String) Connection origin filter (ANY, REMOTE, SITE)
- `country` (Attributes Set) Countries (see [below for nested schema](#nestedatt--rule--country))
- `description` (String) Description of the rule
- `device_posture_profile` (Attributes Set) Device posture profiles (see [below for nested schema](#nestedatt--rule--device_posture_profile))
- `platform` (String) Platform filter (ANDROID, EMBEDDED, IOS, LINUX, MACOS, WINDOWS)
- `source` (Attributes) Source traffic matching criteria. Logical 'OR' is applied within the criteria set. Logical 'AND' is applied between criteria sets. (see [below for nested schema](#nestedatt--rule--source))
- `untrusted_certificate_action` (String) Action for untrusted certificates (ALLOW, BLOCK, PROMPT)

Read-Only:

- `id` (String) ID of the rule
- `index` (Number) Rule Index - computed value that may change due to rule reordering

<a id="nestedatt--rule--application"></a>
### Nested Schema for `rule.application`

Optional:

- `app_category` (Attributes Set) Application categories (see [below for nested schema](#nestedatt--rule--application--app_category))
- `application` (Attributes Set) Applications (see [below for nested schema](#nestedatt--rule--application--application))
- `country` (Attributes Set) Countries (see [below for nested schema](#nestedatt--rule--application--country))
- `custom_app` (Attributes Set) Custom applications (see [below for nested schema](#nestedatt--rule--application--custom_app))
- `custom_category` (Attributes Set) Custom categories (see [below for nested schema](#nestedatt--rule--application--custom_category))
- `custom_service` (Attributes) Custom service definition (see [below for nested schema](#nestedatt--rule--application--custom_service))
- `custom_service_ip` (Attributes) Custom service IP definition (see [below for nested schema](#nestedatt--rule--application--custom_service_ip))
- `domain` (List of String) Domain list
- `fqdn` (List of String) FQDN list
- `global_ip_range` (Attributes Set) Global IP ranges (see [below for nested schema](#nestedatt--rule--application--global_ip_range))
- `ip` (List of String) IPv4 address list
- `ip_range` (Attributes List) IP address ranges (see [below for nested schema](#nestedatt--rule--application--ip_range))
- `remote_asn` (List of String) Remote ASN list
- `service` (Attributes Set) Services (see [below for nested schema](#nestedatt--rule--application--service))
- `subnet` (List of String) Subnet list
- `tls_inspect_category` (String) TLS Inspection category (POPULAR_CLOUD_APPS, STREAMING_MEDIA)

<a id="nestedatt--rule--application--app_category"></a>
### Nested Schema for `rule.application.app_category`

Optional:

- `id` (String) App category ID
- `name` (String) App category name


<a id="nestedatt--rule--application--application"></a>
### Nested Schema for `rule.application.application`

Optional:

- `id` (String) Application ID
- `name` (String) Application name


<a id="nestedatt--rule--application--country"></a>
### Nested Schema for `rule.application.country`

Optional:

- `id` (String) Country ID
- `name` (String) Country name


<a id="nestedatt--rule--application--custom_app"></a>
### Nested Schema for `rule.application.custom_app`

Optional:

- `id` (String) Custom app ID
- `name` (String) Custom app name


<a id="nestedatt--rule--application--custom_category"></a>
### Nested Schema for `rule.application.custom_category`

Optional:

- `id` (String) Custom category ID
- `name` (String) Custom category name


<a id="nestedatt--rule--application--custom_service"></a>
### Nested Schema for `rule.application.custom_service`

Required:

- `protocol` (String) Protocol (TCP, UDP, ICMP, ANY)

Optional:

- `port` (List of String) Port list
- `port_range` (Attributes) Port range (see [below for nested schema](#nestedatt--rule--application--custom_service--port_range))

<a id="nestedatt--rule--application--custom_service--port_range"></a>
### Nested Schema for `rule.application.custom_service.port_range`

Required:

- `from` (String) Start port
- `to` (String) End port



<a id="nestedatt--rule--application--custom_service_ip"></a>
### Nested Schema for `rule.application.custom_service_ip`

Required:

- `name` (String) Service name

Optional:

- `ip` (String) IP address
- `ip_range` (Attributes) IP range (see [below for nested schema](#nestedatt--rule--application--custom_service_ip--ip_range))

<a id="nestedatt--rule--application--custom_service_ip--ip_range"></a>
### Nested Schema for `rule.application.custom_service_ip.ip_range`

Required:

- `from` (String) Start IP
- `to` (String) End IP



<a id="nestedatt--rule--application--global_ip_range"></a>
### Nested Schema for `rule.application.global_ip_range`

Optional:

- `id` (String) Global IP range ID
- `name` (String) Global IP range name


<a id="nestedatt--rule--application--ip_range"></a>
### Nested Schema for `rule.application.ip_range`

Required:

- `from` (String) Range start IP address
- `to` (String) Range end IP address


<a id="nestedatt--rule--application--service"></a>
### Nested Schema for `rule.application.service`

Optional:

- `id` (String) Service ID
- `name` (String) Service name



<a id="nestedatt--rule--country"></a>
### Nested Schema for `rule.country`

Optional:

- `id` (String) Country ID
- `name` (String) Country name


<a id="nestedatt--rule--device_posture_profile"></a>
### Nested Schema for `rule.device_posture_profile`

Optional:

- `id` (String) Device posture profile ID
- `name` (String) Device posture profile name


<a id="nestedatt--rule--source"></a>
### Nested Schema for `rule.source`

Optional:

- `floating_subnet` (Attributes Set) Floating subnets (see [below for nested schema](#nestedatt--rule--source--floating_subnet))
- `global_ip_range` (Attributes Set) Global IP ranges (see [below for nested schema](#nestedatt--rule--source--global_ip_range))
- `group` (Attributes Set) Groups (see [below for nested schema](#nestedatt--rule--source--group))
- `host` (Attributes Set) Hosts and servers defined for your account (see [below for nested schema](#nestedatt--rule--source--host))
- `ip` (List of String) IPv4 address list
- `ip_range` (Attributes List) IP address ranges (see [below for nested schema](#nestedatt--rule--source--ip_range))
- `network_interface` (Attributes Set) Network interfaces (see [below for nested schema](#nestedatt--rule--source--network_interface))
- `site` (Attributes Set) Sites defined for your account (see [below for nested schema](#nestedatt--rule--source--site))
- `site_network_subnet` (Attributes Set) Site network subnets (see [below for nested schema](#nestedatt--rule--source--site_network_subnet))
- `subnet` (List of String) Subnet list
- `system_group` (Attributes Set) System groups (see [below for nested schema](#nestedatt--rule--source--system_group))
- `user` (Attributes Set) Users (see [below for nested schema](#nestedatt--rule--source--user))
- `users_group` (Attributes Set) User groups (see [below for nested schema](#nestedatt--rule--source--users_group))

<a id="nestedatt--rule--source--floating_subnet"></a>
### Nested Schema for `rule.source.floating_subnet`

Optional:

- `id` (String) Floating subnet ID
- `name` (String) Floating subnet name


<a id="nestedatt--rule--source--global_ip_range"></a>
### Nested Schema for `rule.source.global_ip_range`

Optional:

- `id` (String) Global IP range ID
- `name` (String) Global IP range name


<a id="nestedatt--rule--source--group"></a>
### Nested Schema for `rule.source.group`

Optional:

- `id` (String) Group ID
- `name` (String) Group name


<a id="nestedatt--rule--source--host"></a>
### Nested Schema for `rule.source.host`

Optional:

- `id` (String) Host ID
- `name` (String) Host name


<a id="nestedatt--rule--source--ip_range"></a>
### Nested Schema for `rule.source.ip_range`

Required:

- `from` (String) Range start IP address
- `to` (String) Range end IP address


<a id="nestedatt--rule--source--network_interface"></a>
### Nested Schema for `rule.source.network_interface`

Optional:

- `id` (String) Network interface ID
- `name` (String) Network interface name


<a id="nestedatt--rule--source--site"></a>
### Nested Schema for `rule.source.site`

Optional:

- `id` (String) Site ID
- `name` (String) Site name


<a id="nestedatt--rule--source--site_network_subnet"></a>
### Nested Schema for `rule.source.site_network_subnet`

Optional:

- `id` (String) Site network subnet ID
- `name` (String) Site network subnet name


<a id="nestedatt--rule--source--system_group"></a>
### Nested Schema for `rule.source.system_group`

Optional:

- `id` (String) System group ID
- `name` (String) System group name


<a id="nestedatt--rule--source--user"></a>
### Nested Schema for `rule.source.user`

Optional:

- `id` (String) User ID
- `name` (String) User name


<a id="nestedatt--rule--source--users_group"></a>
### Nested Schema for `rule.source.users_group`

Optional:

- `id` (String) User group ID
- `name` (String) User group name
