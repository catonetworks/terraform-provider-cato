---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "cato_socket_lan_firewall_rule Resource - terraform-provider-cato"
subcategory: ""
description: |-
  The cato_socket_lan_firewall_rule resource contains the configuration parameters necessary to add a Socket LAN firewall rule (child rule under a network rule). Documentation for the underlying API used in this resource can be found at mutation.policy.socketLan.firewall.addRule() https://api.catonetworks.com/documentation/#mutation-policy.socketLan.firewall.addRule.
---

# cato_socket_lan_firewall_rule (Resource)

The `cato_socket_lan_firewall_rule` resource contains the configuration parameters necessary to add a Socket LAN firewall rule (child rule under a network rule). Documentation for the underlying API used in this resource can be found at [mutation.policy.socketLan.firewall.addRule()](https://api.catonetworks.com/documentation/#mutation-policy.socketLan.firewall.addRule).

## Example Usage

```terraform
# Socket LAN Firewall Rules are child rules of Socket LAN Network Rules
# They provide granular firewall control within a network rule's scope
# IMPORTANT: A parent network rule must exist before creating firewall rules

# First, create a parent network rule
resource "cato_socket_lan_network_rule" "parent_rule" {
  at = {
    position = "LAST_IN_POLICY"
  }
  rule = {
    name      = "Parent Network Rule"
    enabled   = true
    direction = "TO"
    transport = "LAN"
    site = {
      site = [
        {
          name = "My Site"
        }
      ]
    }
    source      = {}
    destination = {}
  }
}

# Example 1: Minimal Firewall Rule - Allow All
# Basic allow rule with event tracking
resource "cato_socket_lan_firewall_rule" "allow_all" {
  at = {
    position = "FIRST_IN_RULE"
    ref      = cato_socket_lan_network_rule.parent_rule.rule.id
  }
  rule = {
    name      = "Allow All Traffic"
    enabled   = true
    direction = "TO"
    action    = "ALLOW"
    source      = {}
    destination = {}
    tracking = {
      event = {
        enabled = true
      }
      alert = {
        enabled   = false
        frequency = "DAILY"
      }
    }
  }
}

# Example 2: Block Rule with Service Filtering
# Block specific ports with weekly alerts
resource "cato_socket_lan_firewall_rule" "block_ports" {
  at = {
    position = "LAST_IN_RULE"
    ref      = cato_socket_lan_network_rule.parent_rule.rule.id
  }
  rule = {
    name      = "Block Insecure HTTP"
    enabled   = true
    direction = "BOTH"
    action    = "BLOCK"
    source      = {}
    destination = {}
    service = {
      custom = [
        {
          port = [
            "80"
          ]
          protocol = "TCP"
        }
      ]
    }
    tracking = {
      event = {
        enabled = true
      }
      alert = {
        enabled   = true
        frequency = "WEEKLY"
        # Optional: Add subscription groups for alerts
        # subscription_group = [
        #   {
        #     id = "group-id"
        #   }
        # ]
      }
    }
  }
}

# Example 3: Firewall Rule with Source/Destination Filtering
# Control traffic between specific VLANs and IPs
resource "cato_socket_lan_firewall_rule" "vlan_control" {
  at = {
    position = "FIRST_IN_RULE"
    ref      = cato_socket_lan_network_rule.parent_rule.rule.id
  }
  rule = {
    name        = "VLAN 100 to VLAN 200"
    description = "Allow traffic from VLAN 100 to VLAN 200"
    enabled     = true
    direction   = "TO"
    action      = "ALLOW"
    source = {
      vlan = [
        100
      ]
      ip = [
        "192.168.1.0/24"
      ]
    }
    destination = {
      vlan = [
        200
      ]
    }
    tracking = {
      event = {
        enabled = true
      }
      alert = {
        enabled = false
        frequency = "DAILY"
      }
    }
  }
}

# Example 4: Comprehensive Firewall Rule (Kitchen Sink)
# Full example with all available options
resource "cato_socket_lan_firewall_rule" "kitchen_sink" {
  at = {
    position = "FIRST_IN_RULE"
    ref      = cato_socket_lan_network_rule.parent_rule.rule.id
  }
  rule = {
    name        = "Comprehensive Firewall Rule"
    description = "Full example demonstrating all available options"
    enabled     = true
    direction   = "TO"
    action      = "ALLOW"
    source = {
      # VLAN IDs
      vlan = [
        100,
        200
      ]
      # MAC addresses
      mac = [
        "00:11:22:33:44:55",
        "AA:BB:CC:DD:EE:FF"
      ]
      # Specific IP addresses
      ip = [
        "192.168.1.10"
      ]
      # Subnets in CIDR notation
      subnet = [
        "10.0.0.0/24"
      ]
      # IP address ranges
      ip_range = [
        {
          from = "192.168.1.1"
          to   = "192.168.1.100"
        }
      ]
      # Reference sites by name or ID
      site = [
        {
          name = "Branch Office"
        }
      ]
      # Reference hosts by name or ID
      host = [
        {
          name = "server1"
        }
      ]
      # Global IP ranges
      global_ip_range = [
        {
          name = "Corporate IPs"
        }
      ]
      # Floating subnets
      floating_subnet = [
        {
          id = "12345"
        }
      ]
      # Network interfaces
      network_interface = [
        {
          id = "67890"
        }
      ]
      # Site network subnets
      site_network_subnet = [
        {
          id = "subnet123"
        }
      ]
      # System groups
      system_group = [
        {
          name = "All Sites"
        }
      ]
    }
    destination = {
      vlan = [
        300
      ]
      ip = [
        "10.10.10.1"
      ]
      subnet = [
        "172.16.0.0/16"
      ]
      ip_range = [
        {
          from = "10.0.0.1"
          to   = "10.0.0.50"
        }
      ]
      site = [
        {
          name = "Data Center"
        }
      ]
      host = [
        {
          name = "destination-server"
        }
      ]
      global_ip_range = [
        {
          name = "Remote Office IPs"
        }
      ]
    }
    # Application filtering (for application-aware firewall rules)
    application = {
      application = [
        {
          name = "Adobe"
        }
      ]
      custom_app = [
        {
          name = "My Custom App"
        }
      ]
      domain = [
        "example.com"
      ]
      fqdn = [
        "www.example.com"
      ]
      ip = [
        "8.8.8.8"
      ]
      subnet = [
        "8.8.0.0/16"
      ]
      ip_range = [
        {
          from = "9.9.9.1"
          to   = "9.9.9.10"
        }
      ]
      global_ip_range = [
        {
          name = "DNS Servers"
        }
      ]
    }
    # Service/port filtering
    service = {
      simple = [
        {
          name = "FTP"
        },
        {
          name = "HTTP"
        }
      ]
      standard = [
        {
          name = "3PC"
        }
      ]
      custom = [
        {
          port = [
            "443",
            "8443"
          ]
          protocol = "TCP"
        }
      ]
    }
    # Event tracking and alerting
    tracking = {
      event = {
        enabled = true
      }
      alert = {
        enabled   = true
        frequency = "WEEKLY"
        # Webhook notifications
        webhook = [
          {
            name = "My Webhook"
          }
        ]
        # Email mailing list notifications
        mailing_list = [
          {
            name = "Security Team"
          }
        ]
      }
    }
  }
}

## Position Options for 'at' block:
# - FIRST_IN_RULE: Insert at the beginning of the parent rule's firewall rules
# - LAST_IN_RULE: Insert at the end of the parent rule's firewall rules
# - BEFORE_RULE: Insert before a specific firewall rule (requires ref)
# - AFTER_RULE: Insert after a specific firewall rule (requires ref)

## Direction Options:
# - TO: Traffic going to the destination
# - BOTH: Traffic in both directions

## Action Options:
# - ALLOW: Allow the traffic
# - BLOCK: Block the traffic

## Alert Frequency Options:
# - HOURLY
# - DAILY
# - WEEKLY
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `at` (Attributes) Position of the rule relative to the parent network rule (see [below for nested schema](#nestedatt--at))
- `rule` (Attributes) Parameters for the Socket LAN firewall rule (see [below for nested schema](#nestedatt--rule))

<a id="nestedatt--at"></a>
### Nested Schema for `at`

Required:

- `position` (String) Position relative to the parent rule (FIRST_IN_RULE, LAST_IN_RULE, AFTER_RULE, BEFORE_RULE)
- `ref` (String) The parent network rule ID or sibling firewall rule ID


<a id="nestedatt--rule"></a>
### Nested Schema for `rule`

Required:

- `action` (String) Action (ALLOW, BLOCK)
- `destination` (Attributes) Destination traffic matching criteria (see [below for nested schema](#nestedatt--rule--destination))
- `direction` (String) Direction of the traffic (TO, BOTH)
- `enabled` (Boolean) Enable or disable the rule
- `name` (String) Name of the rule
- `source` (Attributes) Source traffic matching criteria (see [below for nested schema](#nestedatt--rule--source))
- `tracking` (Attributes) Tracking information when the rule is matched, such as events and notifications (see [below for nested schema](#nestedatt--rule--tracking))

Optional:

- `application` (Attributes) Application matching criteria (see [below for nested schema](#nestedatt--rule--application))
- `description` (String) Description of the rule
- `service` (Attributes) Service matching criteria (see [below for nested schema](#nestedatt--rule--service))

Read-Only:

- `id` (String) ID of the rule
- `index` (Number) Rule Index

<a id="nestedatt--rule--destination"></a>
### Nested Schema for `rule.destination`

Optional:

- `floating_subnet` (Attributes Set) Floating subnets (see [below for nested schema](#nestedatt--rule--destination--floating_subnet))
- `global_ip_range` (Attributes Set) Global IP ranges (see [below for nested schema](#nestedatt--rule--destination--global_ip_range))
- `group` (Attributes Set) Groups (see [below for nested schema](#nestedatt--rule--destination--group))
- `host` (Attributes Set) Hosts (see [below for nested schema](#nestedatt--rule--destination--host))
- `ip` (List of String) IP addresses
- `ip_range` (Attributes List) IP ranges (see [below for nested schema](#nestedatt--rule--destination--ip_range))
- `network_interface` (Attributes Set) Network interfaces (see [below for nested schema](#nestedatt--rule--destination--network_interface))
- `site` (Attributes Set) Sites (see [below for nested schema](#nestedatt--rule--destination--site))
- `site_network_subnet` (Attributes Set) Site network subnets (see [below for nested schema](#nestedatt--rule--destination--site_network_subnet))
- `subnet` (List of String) Subnets in CIDR notation
- `system_group` (Attributes Set) System groups (see [below for nested schema](#nestedatt--rule--destination--system_group))
- `vlan` (List of Number) VLAN IDs

<a id="nestedatt--rule--destination--floating_subnet"></a>
### Nested Schema for `rule.destination.floating_subnet`

Optional:

- `id` (String) Floating subnet ID
- `name` (String) Floating subnet name


<a id="nestedatt--rule--destination--global_ip_range"></a>
### Nested Schema for `rule.destination.global_ip_range`

Optional:

- `id` (String) Global IP range ID
- `name` (String) Global IP range name


<a id="nestedatt--rule--destination--group"></a>
### Nested Schema for `rule.destination.group`

Optional:

- `id` (String) Group ID
- `name` (String) Group name


<a id="nestedatt--rule--destination--host"></a>
### Nested Schema for `rule.destination.host`

Optional:

- `id` (String) Host ID
- `name` (String) Host name


<a id="nestedatt--rule--destination--ip_range"></a>
### Nested Schema for `rule.destination.ip_range`

Required:

- `from` (String) Start IP
- `to` (String) End IP


<a id="nestedatt--rule--destination--network_interface"></a>
### Nested Schema for `rule.destination.network_interface`

Optional:

- `id` (String) Network interface ID
- `name` (String) Network interface name


<a id="nestedatt--rule--destination--site"></a>
### Nested Schema for `rule.destination.site`

Optional:

- `id` (String) Site ID
- `name` (String) Site name


<a id="nestedatt--rule--destination--site_network_subnet"></a>
### Nested Schema for `rule.destination.site_network_subnet`

Optional:

- `id` (String) Site network subnet ID
- `name` (String) Site network subnet name


<a id="nestedatt--rule--destination--system_group"></a>
### Nested Schema for `rule.destination.system_group`

Optional:

- `id` (String) System group ID
- `name` (String) System group name



<a id="nestedatt--rule--source"></a>
### Nested Schema for `rule.source`

Optional:

- `floating_subnet` (Attributes Set) Floating subnets (see [below for nested schema](#nestedatt--rule--source--floating_subnet))
- `global_ip_range` (Attributes Set) Global IP ranges (see [below for nested schema](#nestedatt--rule--source--global_ip_range))
- `group` (Attributes Set) Groups (see [below for nested schema](#nestedatt--rule--source--group))
- `host` (Attributes Set) Hosts (see [below for nested schema](#nestedatt--rule--source--host))
- `ip` (List of String) IP addresses
- `ip_range` (Attributes List) IP ranges (see [below for nested schema](#nestedatt--rule--source--ip_range))
- `mac` (List of String) MAC addresses
- `network_interface` (Attributes Set) Network interfaces (see [below for nested schema](#nestedatt--rule--source--network_interface))
- `site` (Attributes Set) Sites (see [below for nested schema](#nestedatt--rule--source--site))
- `site_network_subnet` (Attributes Set) Site network subnets (see [below for nested schema](#nestedatt--rule--source--site_network_subnet))
- `subnet` (List of String) Subnets in CIDR notation
- `system_group` (Attributes Set) System groups (see [below for nested schema](#nestedatt--rule--source--system_group))
- `vlan` (List of Number) VLAN IDs

<a id="nestedatt--rule--source--floating_subnet"></a>
### Nested Schema for `rule.source.floating_subnet`

Optional:

- `id` (String) Floating subnet ID
- `name` (String) Floating subnet name


<a id="nestedatt--rule--source--global_ip_range"></a>
### Nested Schema for `rule.source.global_ip_range`

Optional:

- `id` (String) Global IP range ID
- `name` (String) Global IP range name


<a id="nestedatt--rule--source--group"></a>
### Nested Schema for `rule.source.group`

Optional:

- `id` (String) Group ID
- `name` (String) Group name


<a id="nestedatt--rule--source--host"></a>
### Nested Schema for `rule.source.host`

Optional:

- `id` (String) Host ID
- `name` (String) Host name


<a id="nestedatt--rule--source--ip_range"></a>
### Nested Schema for `rule.source.ip_range`

Required:

- `from` (String) Start IP
- `to` (String) End IP


<a id="nestedatt--rule--source--network_interface"></a>
### Nested Schema for `rule.source.network_interface`

Optional:

- `id` (String) Network interface ID
- `name` (String) Network interface name


<a id="nestedatt--rule--source--site"></a>
### Nested Schema for `rule.source.site`

Optional:

- `id` (String) Site ID
- `name` (String) Site name


<a id="nestedatt--rule--source--site_network_subnet"></a>
### Nested Schema for `rule.source.site_network_subnet`

Optional:

- `id` (String) Site network subnet ID
- `name` (String) Site network subnet name


<a id="nestedatt--rule--source--system_group"></a>
### Nested Schema for `rule.source.system_group`

Optional:

- `id` (String) System group ID
- `name` (String) System group name



<a id="nestedatt--rule--tracking"></a>
### Nested Schema for `rule.tracking`

Required:

- `event` (Attributes) When enabled, create an event each time the rule is matched (see [below for nested schema](#nestedatt--rule--tracking--event))

Optional:

- `alert` (Attributes) When enabled, send an alert each time the rule is matched (see [below for nested schema](#nestedatt--rule--tracking--alert))

<a id="nestedatt--rule--tracking--event"></a>
### Nested Schema for `rule.tracking.event`

Optional:

- `enabled` (Boolean) Enable event creation


<a id="nestedatt--rule--tracking--alert"></a>
### Nested Schema for `rule.tracking.alert`

Optional:

- `enabled` (Boolean) Alert creation enabled
- `frequency` (String) Returns data for the alert frequency (https://api.catonetworks.com/documentation/#definition-PolicyRuleTrackingFrequencyEnum)
- `mailing_list` (Attributes Set) Returns data for the Mailing List that receives the alert (see [below for nested schema](#nestedatt--rule--tracking--alert--mailing_list))
- `subscription_group` (Attributes Set) Returns data for the Subscription Group that receives the alert (see [below for nested schema](#nestedatt--rule--tracking--alert--subscription_group))
- `webhook` (Attributes Set) Returns data for the Webhook that receives the alert (see [below for nested schema](#nestedatt--rule--tracking--alert--webhook))

<a id="nestedatt--rule--tracking--alert--mailing_list"></a>
### Nested Schema for `rule.tracking.alert.mailing_list`

Optional:

- `id` (String) Mailing List ID
- `name` (String) Mailing List Name


<a id="nestedatt--rule--tracking--alert--subscription_group"></a>
### Nested Schema for `rule.tracking.alert.subscription_group`

Optional:

- `id` (String) Subscription Group ID
- `name` (String) Subscription Group Name


<a id="nestedatt--rule--tracking--alert--webhook"></a>
### Nested Schema for `rule.tracking.alert.webhook`

Optional:

- `id` (String) Webhook ID
- `name` (String) Webhook Name




<a id="nestedatt--rule--application"></a>
### Nested Schema for `rule.application`

Optional:

- `application` (Attributes Set) Applications (see [below for nested schema](#nestedatt--rule--application--application))
- `custom_app` (Attributes Set) Custom applications (see [below for nested schema](#nestedatt--rule--application--custom_app))
- `domain` (List of String) Domains
- `fqdn` (List of String) FQDNs
- `global_ip_range` (Attributes Set) Global IP ranges (see [below for nested schema](#nestedatt--rule--application--global_ip_range))
- `ip` (List of String) IP addresses
- `ip_range` (Attributes List) IP ranges (see [below for nested schema](#nestedatt--rule--application--ip_range))
- `subnet` (List of String) Subnets

<a id="nestedatt--rule--application--application"></a>
### Nested Schema for `rule.application.application`

Optional:

- `id` (String) Application ID
- `name` (String) Application name


<a id="nestedatt--rule--application--custom_app"></a>
### Nested Schema for `rule.application.custom_app`

Optional:

- `id` (String) Custom app ID
- `name` (String) Custom app name


<a id="nestedatt--rule--application--global_ip_range"></a>
### Nested Schema for `rule.application.global_ip_range`

Optional:

- `id` (String) Global IP range ID
- `name` (String) Global IP range name


<a id="nestedatt--rule--application--ip_range"></a>
### Nested Schema for `rule.application.ip_range`

Required:

- `from` (String) Start IP
- `to` (String) End IP



<a id="nestedatt--rule--service"></a>
### Nested Schema for `rule.service`

Optional:

- `custom` (Attributes List) Custom Service defined by a combination of L4 ports and an IP Protocol (see [below for nested schema](#nestedatt--rule--service--custom))
- `simple` (Attributes Set) Simple services (see [below for nested schema](#nestedatt--rule--service--simple))
- `standard` (Attributes Set) Standard services (see [below for nested schema](#nestedatt--rule--service--standard))

<a id="nestedatt--rule--service--custom"></a>
### Nested Schema for `rule.service.custom`

Optional:

- `port` (List of String) List of TCP/UDP port
- `port_range` (Attributes) TCP/UDP port ranges (see [below for nested schema](#nestedatt--rule--service--custom--port_range))
- `protocol` (String) IP Protocol (https://api.catonetworks.com/documentation/#definition-IpProtocol)

<a id="nestedatt--rule--service--custom--port_range"></a>
### Nested Schema for `rule.service.custom.port_range`

Required:

- `from` (String)
- `to` (String)



<a id="nestedatt--rule--service--simple"></a>
### Nested Schema for `rule.service.simple`

Required:

- `name` (String) Service name


<a id="nestedatt--rule--service--standard"></a>
### Nested Schema for `rule.service.standard`

Optional:

- `id` (String) Service ID
- `name` (String) Service name
