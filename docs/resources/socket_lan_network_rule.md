---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "cato_socket_lan_network_rule Resource - terraform-provider-cato"
subcategory: ""
description: |-
  The cato_socket_lan_network_rule resource contains the configuration parameters necessary to add a Socket LAN network rule. Documentation for the underlying API used in this resource can be found at mutation.policy.socketLan.addRule() https://api.catonetworks.com/documentation/#mutation-policy.socketLan.addRule.
---

# cato_socket_lan_network_rule (Resource)

The `cato_socket_lan_network_rule` resource contains the configuration parameters necessary to add a Socket LAN network rule. Documentation for the underlying API used in this resource can be found at [mutation.policy.socketLan.addRule()](https://api.catonetworks.com/documentation/#mutation-policy.socketLan.addRule).

## Example Usage

```terraform
# Socket LAN Network Rules control network traffic routing between LAN segments
# Network rules define the transport (LAN/WAN) and can enable NAT

# Example 1: Minimal Network Rule with NAT
# Basic rule for traffic going TO a destination with NAT enabled
resource "cato_socket_lan_network_rule" "minimal_nat" {
  at = {
    position = "LAST_IN_POLICY"
  }
  rule = {
    name      = "LAN to WAN with NAT"
    enabled   = true
    direction = "TO"
    transport = "LAN"
    site = {
      site = [
        {
          name = "My Site"
        }
      ]
    }
    source      = {}
    destination = {}
    nat = {
      enabled  = true
      nat_type = "DYNAMIC_PAT"
    }
  }
}

# Example 2: Network Rule within a Section
# Place rules within sections for better organization
resource "cato_socket_lan_section" "network_section" {
  at = {
    position = "LAST_IN_POLICY"
  }
  section = {
    name = "Network Rules Section"
  }
}

resource "cato_socket_lan_network_rule" "in_section" {
  at = {
    position = "FIRST_IN_SECTION"
    ref      = cato_socket_lan_section.network_section.section.id
  }
  rule = {
    name      = "Network Rule in Section"
    enabled   = true
    direction = "BOTH"
    transport = "LAN"
    site = {
      site = [
        {
          name = "My Site"
        }
      ]
    }
    source      = {}
    destination = {}
  }
}

# Example 3: Network Rule with Service Filtering
# Filter traffic by specific ports and protocols
resource "cato_socket_lan_network_rule" "with_service" {
  at = {
    position = "LAST_IN_POLICY"
  }
  rule = {
    name      = "Web Traffic Only"
    enabled   = true
    direction = "TO"
    transport = "LAN"
    site = {
      site = [
        {
          name = "My Site"
        }
      ]
    }
    source      = {}
    destination = {}
    service = {
      simple = [
        {
          name = "HTTP"
        },
        {
          name = "HTTPS"
        }
      ]
      custom = [
        {
          port = [
            "8080",
            "8443"
          ]
          protocol = "TCP"
        }
      ]
    }
  }
}

# Example 4: Comprehensive Network Rule (Kitchen Sink)
# Full example with all source, destination, and service options
resource "cato_socket_lan_network_rule" "kitchen_sink" {
  at = {
    position = "LAST_IN_POLICY"
  }
  rule = {
    name        = "Comprehensive Network Rule"
    description = "Full example with all available options"
    enabled     = true
    direction   = "TO"
    transport   = "LAN"
    site = {
      site = [
        {
          name = "My Site"
        }
      ]
    }
    source = {
      # VLAN IDs
      vlan = [
        100,
        200
      ]
      # Specific IP addresses
      ip = [
        "192.168.1.10"
      ]
      # Subnets in CIDR notation
      subnet = [
        "10.0.0.0/24"
      ]
      # IP address ranges
      ip_range = [
        {
          from = "192.168.1.1"
          to   = "192.168.1.100"
        }
      ]
      # Reference hosts by ID or name
      host = [
        {
          name = "server1"
        }
      ]
      # Global IP ranges
      global_ip_range = [
        {
          name = "Corporate IPs"
        }
      ]
      # Floating subnets
      floating_subnet = [
        {
          id = "12345"
        }
      ]
      # Network interfaces
      network_interface = [
        {
          id = "67890"
        }
      ]
      # Site network subnets
      site_network_subnet = [
        {
          id = "subnet123"
        }
      ]
      # System groups
      system_group = [
        {
          name = "All Sites"
        }
      ]
    }
    destination = {
      vlan = [
        300
      ]
      ip = [
        "10.10.10.1"
      ]
      subnet = [
        "172.16.0.0/16"
      ]
      ip_range = [
        {
          from = "10.0.0.1"
          to   = "10.0.0.50"
        }
      ]
      host = [
        {
          name = "destination-server"
        }
      ]
      global_ip_range = [
        {
          name = "Remote Office IPs"
        }
      ]
    }
    service = {
      # Simple service by name
      simple = [
        {
          name = "FTP"
        },
        {
          name = "HTTP"
        }
      ]
      # Custom port/protocol combinations
      custom = [
        {
          port = [
            "443",
            "8443"
          ]
          protocol = "TCP"
        }
      ]
    }
    nat = {
      enabled  = true
      nat_type = "DYNAMIC_PAT"
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `at` (Attributes) Position of the rule in the policy (see [below for nested schema](#nestedatt--at))
- `rule` (Attributes) Parameters for the Socket LAN network rule (see [below for nested schema](#nestedatt--rule))

<a id="nestedatt--at"></a>
### Nested Schema for `at`

Required:

- `position` (String) Position relative to a policy, a section or another rule

Optional:

- `ref` (String) The identifier of the object (e.g. a rule, a section) relative to which the position of the added rule is defined


<a id="nestedatt--rule"></a>
### Nested Schema for `rule`

Required:

- `destination` (Attributes) Destination traffic matching criteria (see [below for nested schema](#nestedatt--rule--destination))
- `direction` (String) Direction of the traffic (TO, BOTH)
- `enabled` (Boolean) Enable or disable the rule
- `name` (String) Name of the rule
- `site` (Attributes) Site scope for the rule (see [below for nested schema](#nestedatt--rule--site))
- `source` (Attributes) Source traffic matching criteria (see [below for nested schema](#nestedatt--rule--source))
- `transport` (String) Transport type (LAN, WAN)

Optional:

- `description` (String) Description of the rule
- `nat` (Attributes) NAT settings (see [below for nested schema](#nestedatt--rule--nat))
- `service` (Attributes) Destination service traffic matching criteria. Logical 'OR' is applied within the criteria set. Logical 'AND' is applied between criteria sets. (see [below for nested schema](#nestedatt--rule--service))

Read-Only:

- `id` (String) ID of the rule
- `index` (Number) Rule Index

<a id="nestedatt--rule--destination"></a>
### Nested Schema for `rule.destination`

Optional:

- `floating_subnet` (Attributes Set) Floating Subnets (ie. Floating Ranges) are used to identify traffic exactly matched to the route advertised by BGP. They are not associated with a specific site. This is useful in scenarios such as active-standby high availability routed via BGP. (see [below for nested schema](#nestedatt--rule--destination--floating_subnet))
- `global_ip_range` (Attributes Set) Global IP range matching criteria for the exception. (see [below for nested schema](#nestedatt--rule--destination--global_ip_range))
- `group` (Attributes Set) (see [below for nested schema](#nestedatt--rule--destination--group))
- `host` (Attributes Set) Hosts and servers defined for your account (see [below for nested schema](#nestedatt--rule--destination--host))
- `ip` (List of String) IP addresses
- `ip_range` (Attributes List) IP ranges (see [below for nested schema](#nestedatt--rule--destination--ip_range))
- `network_interface` (Attributes Set) Network range defined for a site (see [below for nested schema](#nestedatt--rule--destination--network_interface))
- `site_network_subnet` (Attributes Set) GlobalRange + InterfaceSubnet (see [below for nested schema](#nestedatt--rule--destination--site_network_subnet))
- `subnet` (List of String) Subnets in CIDR notation
- `system_group` (Attributes Set) (see [below for nested schema](#nestedatt--rule--destination--system_group))
- `vlan` (List of Number) VLAN IDs

<a id="nestedatt--rule--destination--floating_subnet"></a>
### Nested Schema for `rule.destination.floating_subnet`

Optional:

- `id` (String) Floating Subnet ID
- `name` (String) Floating Subnet Name


<a id="nestedatt--rule--destination--global_ip_range"></a>
### Nested Schema for `rule.destination.global_ip_range`

Optional:

- `id` (String) Global IP Range ID
- `name` (String) Global IP Range Name


<a id="nestedatt--rule--destination--group"></a>
### Nested Schema for `rule.destination.group`

Optional:

- `id` (String) Group ID
- `name` (String) Group Name


<a id="nestedatt--rule--destination--host"></a>
### Nested Schema for `rule.destination.host`

Optional:

- `id` (String) Host ID
- `name` (String) Host Name


<a id="nestedatt--rule--destination--ip_range"></a>
### Nested Schema for `rule.destination.ip_range`

Required:

- `from` (String) Start IP
- `to` (String) End IP


<a id="nestedatt--rule--destination--network_interface"></a>
### Nested Schema for `rule.destination.network_interface`

Optional:

- `id` (String) Network Interface ID
- `name` (String) Network Interface Name


<a id="nestedatt--rule--destination--site_network_subnet"></a>
### Nested Schema for `rule.destination.site_network_subnet`

Optional:

- `id` (String) Site Natwork Subnet ID
- `name` (String) Site Natwork Subnet Name


<a id="nestedatt--rule--destination--system_group"></a>
### Nested Schema for `rule.destination.system_group`

Optional:

- `id` (String) System Group ID
- `name` (String) System Group Name



<a id="nestedatt--rule--site"></a>
### Nested Schema for `rule.site`

Optional:

- `group` (Attributes Set) Groups defined for your account (see [below for nested schema](#nestedatt--rule--site--group))
- `site` (Attributes Set) Sites defined in your account (see [below for nested schema](#nestedatt--rule--site--site))

<a id="nestedatt--rule--site--group"></a>
### Nested Schema for `rule.site.group`

Optional:

- `id` (String) Group ID
- `name` (String) Group Name


<a id="nestedatt--rule--site--site"></a>
### Nested Schema for `rule.site.site`

Optional:

- `id` (String) Site ID
- `name` (String) Site Name



<a id="nestedatt--rule--source"></a>
### Nested Schema for `rule.source`

Optional:

- `floating_subnet` (Attributes Set) Floating Subnets (ie. Floating Ranges) are used to identify traffic exactly matched to the route advertised by BGP. They are not associated with a specific site. This is useful in scenarios such as active-standby high availability routed via BGP. (see [below for nested schema](#nestedatt--rule--source--floating_subnet))
- `global_ip_range` (Attributes Set) Global IP range matching criteria for the exception. (see [below for nested schema](#nestedatt--rule--source--global_ip_range))
- `group` (Attributes Set) (see [below for nested schema](#nestedatt--rule--source--group))
- `host` (Attributes Set) Hosts and servers defined for your account (see [below for nested schema](#nestedatt--rule--source--host))
- `ip` (List of String) IP addresses
- `ip_range` (Attributes List) IP ranges (see [below for nested schema](#nestedatt--rule--source--ip_range))
- `network_interface` (Attributes Set) Network range defined for a site (see [below for nested schema](#nestedatt--rule--source--network_interface))
- `site_network_subnet` (Attributes Set) GlobalRange + InterfaceSubnet (see [below for nested schema](#nestedatt--rule--source--site_network_subnet))
- `subnet` (List of String) Subnets in CIDR notation
- `system_group` (Attributes Set) (see [below for nested schema](#nestedatt--rule--source--system_group))
- `vlan` (List of Number) VLAN IDs

<a id="nestedatt--rule--source--floating_subnet"></a>
### Nested Schema for `rule.source.floating_subnet`

Optional:

- `id` (String) Floating Subnet ID
- `name` (String) Floating Subnet Name


<a id="nestedatt--rule--source--global_ip_range"></a>
### Nested Schema for `rule.source.global_ip_range`

Optional:

- `id` (String) Global IP Range ID
- `name` (String) Global IP Range Name


<a id="nestedatt--rule--source--group"></a>
### Nested Schema for `rule.source.group`

Optional:

- `id` (String) Group ID
- `name` (String) Group Name


<a id="nestedatt--rule--source--host"></a>
### Nested Schema for `rule.source.host`

Optional:

- `id` (String) Host ID
- `name` (String) Host Name


<a id="nestedatt--rule--source--ip_range"></a>
### Nested Schema for `rule.source.ip_range`

Required:

- `from` (String) Start IP
- `to` (String) End IP


<a id="nestedatt--rule--source--network_interface"></a>
### Nested Schema for `rule.source.network_interface`

Optional:

- `id` (String) Network Interface ID
- `name` (String) Network Interface Name


<a id="nestedatt--rule--source--site_network_subnet"></a>
### Nested Schema for `rule.source.site_network_subnet`

Optional:

- `id` (String) Site Natwork Subnet ID
- `name` (String) Site Natwork Subnet Name


<a id="nestedatt--rule--source--system_group"></a>
### Nested Schema for `rule.source.system_group`

Optional:

- `id` (String) System Group ID
- `name` (String) System Group Name



<a id="nestedatt--rule--nat"></a>
### Nested Schema for `rule.nat`

Optional:

- `enabled` (Boolean) Enable or disable NAT
- `nat_type` (String) NAT type (DYNAMIC_PAT)


<a id="nestedatt--rule--service"></a>
### Nested Schema for `rule.service`

Optional:

- `custom` (Attributes List) Custom Service defined by a combination of L4 ports and an IP Protocol (see [below for nested schema](#nestedatt--rule--service--custom))
- `simple` (Attributes Set) Simple Service to which this Socket LAN rule applies (see [below for nested schema](#nestedatt--rule--service--simple))

<a id="nestedatt--rule--service--custom"></a>
### Nested Schema for `rule.service.custom`

Optional:

- `port` (List of String) List of TCP/UDP port
- `port_range` (Attributes) TCP/UDP port ranges (see [below for nested schema](#nestedatt--rule--service--custom--port_range))
- `protocol` (String) IP Protocol (https://api.catonetworks.com/documentation/#definition-IpProtocol)

<a id="nestedatt--rule--service--custom--port_range"></a>
### Nested Schema for `rule.service.custom.port_range`

Required:

- `from` (String)
- `to` (String)



<a id="nestedatt--rule--service--simple"></a>
### Nested Schema for `rule.service.simple`

Required:

- `name` (String) Simple Service Name (e.g., HTTP, FTP, SSH)
